// async function fetchData() {

//     var response = await fetch("/api/plotChartPassDSE";

//     if (response.ok) {
//         var data = await response.json();
//     }
// }

document.addEventListener("DOMContentLoaded", function () {

    // var plantPath = `M412.457,314.914H251.863c1.862-3.609,3.995-7.984,6.24-13.026c0.765-0.389,1.559-0.879,2.461-1.48
    // c3.413-3.413,7.68-9.387,12.8-15.36c9.953-12.441,22.329-28.087,36.335-37.575c42.372-0.589,73.473-10.843,92.519-31.545
    // c23.893-23.893,23.04-56.32,23.04-68.267v-2.56c0-5.12-3.413-8.533-8.533-8.533h-1.707c-49.493-0.853-75.947,15.36-90.453,29.013
    // c-17.149,17.149-26.459,40.564-27.231,69.469c-8.948,6.523-16.922,14.579-24.04,22.835
    // c10.637-42.479,13.597-99.851-17.887-158.339c-0.399-30.632-9.738-55.51-27.268-72.205c-13.653-12.8-38.4-28.16-82.773-27.307
    // h-1.707c-5.12,0-7.68,10.24-7.68,10.24c-0.853,11.947-1.707,46.08,23.893,71.68c17.533,18.368,45.691,27.745,81.267,28.141
    // c49.99,95.567,0.922,188.432-8.829,204.819H97.577c-11.947,0-22.187,10.24-22.187,22.187v7.68
    // c0,11.947,10.24,22.187,22.187,22.187h5.483l45.609,128H92.457c-5.12,0-8.533,3.413-8.533,8.533s3.413,8.533,8.533,8.533h62.293
    // h199.68h53.76c5.12,0,8.533-3.413,8.533-8.533s-3.413-8.533-8.533-8.533h-47.742l45.137-128h6.018
    // c11.947,0,22.187-10.24,23.04-22.187v-7.68C434.644,325.154,424.404,314.914,412.457,314.914z M336.51,177.527
    // c11.093-11.093,32.427-23.893,71.68-23.893c0,12.8-1.707,34.133-17.067,51.2c-14.258,13.507-35.118,22.392-63.734,24.92
    // c11.132-10.467,24.743-21.612,33.014-24.92c5.12-1.707,6.827-6.827,5.12-11.093c-1.707-5.12-6.827-6.827-11.093-5.12
    // c-10.58,4.232-25.747,16.66-37.783,27.937C319.543,200.351,326.43,187.608,336.51,177.527z M152.19,17.101
    // c34.133,0.853,52.907,11.947,64,22.187c9.161,9.16,15.246,20.958,18.601,35.363c-10.945-11.054-22.611-20.067-35.667-27.683
    // c-4.267-1.707-9.387-0.853-11.947,3.413c-1.707,4.267-0.853,9.387,3.413,11.947c13.708,8.1,25.591,18.03,36.656,30.102
    // c-24.015-2.208-42.687-9.679-55.429-22.422C154.75,52.941,152.19,29.901,152.19,17.101z M166.697,494.967l-25.6-75.947
    // l6.827,5.973c3.413,2.56,13.653,10.24,30.72,10.24c8.533,0,15.36-4.267,21.333-8.533c2.56-2.56,5.12-4.267,7.68-5.12
    // c13.653-5.12,17.067-4.267,23.893,2.56l33.28,34.987c5.973,6.827,16.213,11.093,28.16,10.24c10.24,0,20.48-4.267,29.867-11.947
    // l12.8-11.093c3.413-2.56,7.68-3.413,11.947-0.853l10.24,5.973l-15.36,43.52H166.697z M363.347,435.921l-8.916-4.954
    // c-9.387-5.973-22.187-5.12-31.573,2.56l-12.8,11.093c-4.267,3.413-11.093,8.533-19.627,8.533c-5.973,0-11.947-1.707-14.507-5.12
    // l-33.28-35.84c-14.507-13.653-26.453-12.8-42.667-5.973c-4.267,1.707-7.68,4.267-11.093,6.827
    // c-4.267,3.413-8.533,5.973-11.947,5.973c-11.093,0-17.067-5.12-19.627-6.827l-28.776-25.234l-7.064-19.992h266.24L363.347,435.921
    // z M417.577,344.781c0,2.56-2.56,5.12-5.12,5.12h-0.853H97.577c-2.56,0-5.12-2.56-5.12-4.267v-7.68c0-6.827,5.12-5.973,5.12-5.973
    // h314.88c2.56,0,5.12,2.56,5.12,5.12V344.781z`

    var plantPath = `m 308.73706,626.22116 c 31.64102,-93.18789 78.31224,-189.85713 142.07426,-294.27605 37.77157,-61.85607 49.57184,-84.91537 60.65919,-118.53626 11.76498,-35.67567 29.38056,-66.84739 43.09473,-76.25853 7.58315,-5.2038 16.4787,-6.99485 42.71357,-8.60006 19.58962,-1.19859 36.47883,-0.75637 41.31353,1.08174 4.4978,1.71008 11.9661,2.19061 16.5964,1.06789 19.4009,-4.70414 63.6986,-24.5473 90.4943,-40.536871 15.8086,-9.43332 36.4129,-20.5436 45.7874,-24.68943 16.5512,-7.31972 17.1556,-8.03421 20.8821,-24.68592 l 3.8376,-17.14804 -17.3346,-17.75513 c -41.0715,-42.06804 -64.1679,-92.17257 -72.5441,-157.375389 -1.1964,-9.3131 -5.1648,-19.85669 -9.7523,-25.91094 -4.2543,-5.61448 -9.8656,-15.30731 -12.4697,-21.53969 -6.1837,-14.79962 -16.8204,-57.15554 -16.8709,-67.18026 -0.023,-4.31829 -3.1738,-13.76927 -7.0048,-21.00221 -5.6156,-10.60264 -6.3602,-14.86236 -3.8428,-21.98399 2.5881,-7.32177 4.9876,-8.86666 14.0228,-9.02859 10.4952,-0.18818 10.8621,-0.5967 9.8702,-10.99202 -0.5667,-5.93816 -1.1646,-32.70214 -1.3288,-59.47553 -0.251,-40.9155 1.0793,-55.87741 8.3406,-93.81612 4.7515,-24.82546 7.4438,-46.33258 5.9828,-47.79357 -4.7947,-4.79465 -149.22795,-46.82466 -160.90974,-46.82466 -4.33881,0 -6.51294,2.02187 -6.51294,6.05681 1.5228,7.88551 4.66327,25.16299 9.2687,48.90321 l 4.66621,45.5383 c 2.56643,25.04607 8.16355,61.24308 12.43804,80.4378 10.87138,48.81812 20.78231,102.29681 20.63654,111.35349 -0.0676,4.19929 2.55643,20.35439 5.83114,35.90024 3.27473,15.54582 8.99273,45.22424 12.70672,65.952 18.47563,103.112819 17.90593,98.928049 13.46853,98.928049 -2.7848,0 -7.20493,-18.549019 -13.0836,-54.905339 -4.16236,-25.7417 -9.95633,-45.59299 -13.30722,-45.59299 -1.30676,0 -2.34704,3.17984 -2.31181,7.06631 0.12562,13.84602 12.44414,98.466829 17.03005,116.986319 4.93814,19.94194 6.04437,39.33992 2.91041,51.03429 -2.59572,9.68588001 -5.29737,8.87071001 -10.40853,-3.14057 l -4.34333,-10.20685 -1.84123,12.56228 c -1.52336,10.39386001 -3.16761,12.71037 -9.52538,13.41991 -4.22633,0.47169 -9.99063,2.94488 -12.80956,5.496 -8.39185,7.59453 -37.17365,6.14024 -46.19414,-2.33407 -4.08204,-3.83487 -10.5328,-7.01470999 -14.335,-7.06630999 -6.54055,-0.0889 -6.86634,-1.27859001 -6.04515,-22.07781001 0.4774,-12.0912 2.22883,-31.87682 3.8921,-43.96801 3.48902,-25.36383 1.72855,-150.169239 -3.12318,-221.410389 -1.82334,-26.77337 -4.17744,-105.53878 -5.23131,-175.0342 -1.32781,-87.5601 -2.9987,-127.2194 -5.44201,-129.16949 -6.17836,-4.93121 -37.29942,-12.28761 -61.2405,-14.47596 -27.87442,-2.54791 -38.07283,-6.03281 -38.07283,-13.00988 0,-9.84648 35.12532,-45.23186 73.6854,-74.23093 21.2107,-15.9515 40.79467,-32.8879 43.51996,-37.6364 2.72526,-4.7485 10.32723,-11.0782 16.89315,-14.0659 6.56598,-2.9877 31.72374,-21.8808 55.90613,-41.9847 24.18242,-20.104 55.98068,-45.1649 70.66288,-55.6908 14.6822,-10.526 46.1024,-33.1141 69.8226,-50.1956 23.7202,-17.0816 54.8119,-38.4327 69.0926,-47.4468 14.2807,-9.0141 29.8163,-19.3783 34.5236,-23.0315 l 8.5586,-6.6422 43.2608,13.5065 c 186.38276,58.1909 319.09956,101.4243 427.98116,139.4181 113.8883,39.7409 149.3175,53.1779 191.3657,72.5783 23.434,10.8119 49.9989,22.0878 59.0334,25.0578 9.0346,2.9699 19.5882,7.9599 23.4526,11.089 6.1708,4.9968 6.4869,6.3385 2.5976,11.0249 -7.5283,9.0711 -47.8897,27.7549 -65.246,30.20336 -18.9359,2.67122 -56.1757,24.36607 -198.2459,115.4923 l -85.9702,55.14288 1.9582,21.06972 c 1.0769,11.58836 4.8868,33.40064 8.4663,48.47172 6.5354,27.51755 7.0662,62.49401 1.2793,84.30099 -2.273,8.56637 -1.9617,8.97746 5.1046,6.73881 19.164,-6.07125 26.2212,-5.53288 33.8448,2.58202 10.0513,10.699 12.9929,44.77263 5.4281,62.87724 -2.8059,6.71574 -5.9392,20.13766 -6.9628,29.82647 -4.2548,40.27571 -41.7226,94.40721 -68.8699,99.50013 -5.858,1.09895 -11.8849,3.61684 -13.3929,5.5953 -1.5082,1.97843 -7.2798,18.13727 -12.8263,35.9085 l -10.0843,32.311319 17.1701,35.21099 c 9.4436,19.36604 19.5927,44.04957 22.5536,54.85228 5.949,21.70511 5.4324,21.15591 59.5083,63.26616 31.5979,24.605921 40.2495,33.294371 69.0925,69.386231 8.6366,10.80708 24.8892,27.10822 36.1166,36.2247 11.2277,9.1165 32.4265,27.3916 47.1086,40.61129 22.5274,20.28356 27.9206,23.724 34.5462,22.03796 28.8762,-7.34808 30.3214,-6.90837 53.2897,16.21364 11.7747,11.85326 29.3423,28.40399 39.0393,36.77932 34.2478,29.58005 58.1066,84.57453 117.5056,270.85036 13.82,43.34027 26.7049,89.27114 28.633,102.06858 14.679,87.04458 14.6561,173.79696 14.6561,262.73684 l 1.9954,7.06628 -733.69006,0 -733.68989,0 c 0,-136.86169 21.83744,-244.19825 48.69331,-323.05867 z M 599.73438,-51.773431 c -1.29082,-21.96583 -6.80883,-30.18844 -6.74707,-10.0541 0.0467,15.2933 2.69915,28.1057 5.81942,28.1124 1.09403,0.002 1.51152,-8.1239 0.92765,-18.0583 z m 32.72636,39.77806 c -4.4312,-13.00093 -10.2042,-55.41275 -8.2586,-60.67235 3.128,-8.4556 4.658,-4.55393 11.2806,28.76529 4.3829,22.05087 4.8991,29.9539 2.137,32.71602 -2.7622,2.76215 -4.0084,2.56673 -5.159,-0.80896 z`;
    
    
    // var pass_num = 20;

    const request = new XMLHttpRequest();
    var url = '/api/plotChartDSE/pass';
    request.open("GET", url);
    request.send();
    // var obj = JSON.parse(request.response);
    // var pass_num = obj.result2[0].count;
    
    request.onload = (e) => {
        alert(request.response);
        var obj = JSON.parse(request.response);
        pass_num = obj.result2[0].count;
        alert( pass_num );
    }

    // var url = '/api/plotChartDSE/fail';
    // request.open("GET", url);
    // request.send();
    
    // request.onload = (e) => {
    //     alert(request.response);
    //     var obj = JSON.parse(request.response);
    //     fail_num = obj.result1[0].count;
    // }
    
    // console.log(data.count);

    // if (response.ok) {
    //     var data = response.json();

    //     pass_num = 342;
    // }

    var root = am5.Root.new("chartdiv_plant");
    var chart = root.container.children.push(
        am5percent.SlicedChart.new(root, {})
    );

    chart.dataSource.url = "datasample.json";
    chart.dataSource.parser = am4core.JSONParser;

    var series = chart.series.push(
        am5percent.PictorialStackedSeries.new(root, {
            svgPath: plantPath,
            categoryField: "name",
            valueField: "value",
        })
    );

    series.get("colors").set("colors", [
        am5.color(0xe0a458),
        am5.color(0x80c5de),
    ]);

    series.slices.template.setAll({
        tooltipText: "{name}: {value}"
    });

    series.datafields.name = "name";
    series.datafields.value = "value";
    // series.data.setAll([{
    //     name: "Pass",
    //     value: pass_num
    // }, {
    //     name: "Not good",
    //     value: 21
    // }]);
});